
# T cells

```{r}
library("reticulate")
# reticulate::py_install(c("scanpy", "python-igraph", "louvain", "loompy"))
```


```{python, eval=FALSE}
import scanpy as sc
ad_processed=sc.read_h5ad("T0_T1_Tcells_global_tcrdata.h5ad")
ad_processed.write_csvs("T0_T1_Tcells_global_tcrdata")
ad_processed.write_loom("T0_T1_Tcells_global_tcrdata/processed.loom")
```

```{r}
library("SingleCellExperiment")
counts_raw <- HDF5Array::HDF5Array(filepath = "T0_T1_Tcells_global_tcrdata/processed.loom", name = "matrix")
sce <- SingleCellExperiment(
  list(
    counts = t(counts_raw), 
    logcounts= t(counts_raw)
  )
)
sce
reducedDims(sce) <- list(
  PCA = rio::import("T0_T1_Tcells_global_tcrdata/obsm.csv")[,1:50], 
  UMAP = rio::import("T0_T1_Tcells_global_tcrdata/obsm.csv")[51:52]
)
sce

# rio::import("T0_T1_Tcells_global_tcrdata/obs.csv")
# rio::import("T0_T1_Tcells_global_tcrdata/var.csv")

rowdata_df <- rio::import("T0_T1_Tcells_global_tcrdata/var.csv")
DataFrame(rowdata_df)
rownames(sce)
rownames(sce) <- rowdata_df$index
sce

colData(sce) <- DataFrame(rio::import("T0_T1_Tcells_global_tcrdata/obs.csv"))
colnames(sce) <- paste0("cell_", seq_len(nrow(colData(sce))))
sce
```

Remaking Fig 5b


```{r}
scater::plotUMAP(sce, colour_by="manual_annotation")

```



```{r}
# saveRDS(sce, "sce_monocytes.RDS")
# sce <- readRDS("sce_monocytes.RDS")
```



```{r eval=FALSE}
library("iSEE")
iSEE(sce)
library("iSEEu")
modeEmpty(sce)

# exported configuration of panels

# exported code for the plots
```


```{r eval=FALSE}
iSEE(sce, initial = initial)
```



```{r}
sessionInfo()
```


